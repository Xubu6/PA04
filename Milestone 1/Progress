Modified producer and consumer code
